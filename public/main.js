function int2hex(a){for(var b=a.toString(16);b.length<8;)b="0"+b;return b.substr(6,2)+b.substr(4,2)+b.substr(2,2)+b.substr(0,2)}function urlencode(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}function ajax(a){function b(b,c){c||(c=null),b.error?"function"==typeof a.error&&a.error(b.error,b,c):"function"==typeof a.success&&a.success(b.result,b,c),"function"==typeof a.complete&&a.complete(b,c)}if(a.method=a.method||"GET",a.url){var c=a.url;a.query&&(c="object"==typeof a.query?c+"?"+urlencode(a.query):c+"?"+a.query),a.type=a.type||"json";var d=new XMLHttpRequest;if(d.open(a.method,c,!0),d.onreadystatechange=function(){if(4==d.readyState){var a={status:500,error:"The server is currently unavailable.",result:null};try{a=JSON.parse(d.responseText)}catch(c){}b(a,d)}},"json"===a.type&&"setRequestHeader"in d&&d.setRequestHeader("Accept","application/json"),a.body){var e=a.body;"object"==typeof e&&("overrideMimeType"in d&&d.overrideMimeType("application/x-www-form-urlencoded"),"setRequestHeader"in d&&d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e=urlencode(e)),d.send(e)}else d.send()}}function significant4(a,b){if("number"!=typeof a)try{a=parseFloat(a)}catch(c){a=0}"number"!=typeof a&&(a=0),isNaN(a)&&(a=0),0>a&&(a=0);var d=a.toFixed(3),e=d.indexOf(".");return 0>e?d:e>=4?d.substr(0,e):b?d.substr(0,5).replace(/(\.?[0]+)$/,""):d.substr(0,5)}function looksMobile(){return/(iphone|ipad|android|ios)/i.test(window.navigator.userAgent)?!0:!1}function notify(a,b){var c=document.createElement("div");c.className="notice"+(b?" "+b:""),c.innerHTML=a,document.body.appendChild(c),setTimeout(function(){c.parentNode.removeChild(c)},5e3)}function getScrollY(){return window.scrollY||document.body.scrollTop||document.body.parentNode.scrollTop}function scrollSmoothly(a){for(var b=300,c=18,d=0;c-1>d;d+=1)setTimeout(function(){var b=a-getScrollY(),d=getScrollY()+b/(c-=1);window.scroll(0,d)},Math.floor(b/c*d))}function prettyLink(a,b){a.addEventListener("click",function(a){return"preventDefault"in a&&a.preventDefault(),scrollSmoothly(b.offsetTop-(canFloatNav&&window.innerWidth>=611?68:0)),!1},!1)}function floatNav(){navFloat.className=getScrollY()>=navigation.offsetTop-10?"floating":""}function updateBalance(){ajax({url:"/api/balance",success:function(a){balanceBlock.innerHTML="<strong>"+significant4(a,!0)+"</strong>Dogecoins"}})}function withdraw(){return ajax({url:"/api/withdraw",success:function(a){notify(a,"success")},error:function(a){notify(a,"error")}}),!1}function workerMessage(a){var b=a.data;if("string"==typeof b)ajax({method:"POST",url:"/api/submit",body:{header:b.substr(0,160),scrypt:b.substr(160,64)}});else{var c=a.target.workSize/((Date.now()-a.target.startedWork)/1e3);a.target.rateHistory.unshift(c),a.target.rateHistory.length>5&&a.target.rateHistory.pop(),a.target.workSize=Math.floor(5*c),workers.sendWork(a.target)}}for(var links=document.getElementsByTagName("a"),i=0,x=links.length,o;x>i;i+=1)if(o=links[i],o.href&&o.href.indexOf("#")>=0){var id=o.href.substr(o.href.indexOf("#")+1),obj=document.getElementById(id);obj&&prettyLink(o,obj)}var canFloatNav=!1;if(!("ontouchstart"in window)){canFloatNav=!0;var navigation=document.getElementById("navigation"),navFloat=document.getElementById("nav-float");window.addEventListener("scroll",floatNav,!1)}var balanceBlock=document.getElementById("balance-block");updateBalance(),setInterval(updateBalance,6e4),document.getElementById("email-form").addEventListener("submit",function(a){"preventDefault"in a&&a.preventDefault();var b=a.target[0].value;return ajax({method:"POST",url:"/api/email",body:{email:b},success:function(){notify("Your email has been saved.","success"),updateBalance()},error:function(a){notify(a,"error")}}),!1},!1);var rateBlock=document.getElementById("rate-block"),pnaclBlock=document.getElementById("pnacl-block"),miningBtn=document.getElementById("mining-toggle-btn"),workers=[];if(workers.mode="OFF",workers.workCache=!1,workers.awaitingWork=[],workers.type=function(){return navigator.mimeTypes["application/x-pnacl"]?"PNACL":"undefined"!=typeof Worker&&"undefined"!=typeof ArrayBuffer?"JS":("undefined"==typeof Worker&&ga("send","event","nosupport","noworker",{nonInteraction:1}),"undefined"==typeof ArrayBuffer&&ga("send","event","nosupport","notypedarrays",{nonInteraction:1}),!1)}(),workers.autoStart=function(){return workers.type?looksMobile()?!1:!0:!1}(),document.body.className=workers.type?workers.autoStart?"auto":"optional":"unsupported",workers.addWorker=function(){if(workers.type&&!(workers.length>=8)){var a;switch(workers.type){case"JS":a=new Worker("/public/worker.js"),a.workSize=250,workers.sendWork(a);break;case"PNACL":a=document.createElement("embed"),a.setAttribute("src","/public/module.nmf"),a.setAttribute("type","application/x-pnacl"),pnaclBlock.appendChild(a),a.workSize=500,a.addEventListener("load",function(){workers.sendWork(a)},!1)}a.rateHistory=[],workers.push(a),a.addEventListener("message",workerMessage,!1),workers.workCache||workers.getWork()}},workers.removeWorker=function(){if(workers.length){var a=workers.pop();switch(workers.type){case"JS":a.terminate();break;case"PNACL":a.parentNode.removeChild(a)}}},workers.findOptimal=function(){if(workers.findOptimalTimeout=null,0==workers.length)return workers.addWorker(),workers.lastHashRate=0,void(workers.findOptimalTimeout=setTimeout(workers.findOptimal,2e4));if(!(workers.length>=8)){var a=workers.getHashRate();if(a<1.1*workers.lastHashRate)return workers.removeWorker();workers.lastHashRate=a,workers.addWorker(),workers.findOptimalTimeout=setTimeout(workers.findOptimal,3e4)}},workers.sendWork=function(a){if(!workers.workCache)return workers.awaitingWork.push(a);a.startedWork=Date.now();var b=workers.workCache.nonce,c=workers.workCache.nonce+=a.workSize,d=workers.workCache.data+int2hex(b)+int2hex(c);a.postMessage(d)},workers.pollWork=function(){ajax({url:"/api/work",query:{poll:"true"},success:function(a){a&&(workers.workCache.data=a,workers.workCache.nonce=0),workers.pollWork()},error:function(){setTimeout(workers.pollWork,1e4)}})},workers.getWork=function(){ajax({url:"/api/work",success:function(a){if(a){workers.workCache||(workers.workCache={}),workers.workCache.data=a,workers.workCache.nonce=0;for(var b=0;b<workers.awaitingWork.length;b+=1)workers.sendWork(workers.awaitingWork[b]);workers.awaitingWork.length=0}workers.pollWork()},error:function(){setTimeout(workers.getWork,5e3)}})},workers.getHashRate=function(){var a,b,c,d,e=0;for(a=0;a<workers.length;a+=1)b=workers[a],b.rateHistory&&b.rateHistory.length>0&&(e+=1);if(0==e)return!1;var f=0;for(a=0;a<workers.length;a+=1)if(b=workers[a].rateHistory,b.length>0){for(d=0,c=0;c<b.length;c+=1)d+=b[c];f+=d/b.length}return f},workers.updateInfo=function(){if(0==workers.length)return rateBlock.innerHTML="<strong>-</strong>Not Mining";var a=workers.getHashRate();return a?void(rateBlock.innerHTML="<strong>"+significant4(a/1e3)+"</strong>Kilohashes"):rateBlock.innerHTML="<strong>-</strong>Warming Up"},setInterval(workers.updateInfo,2500),workers.switchMode=function(a){if(workers.type&&("AUTO"==workers.mode&&"AUTO"!=a&&workers.findOptimalTimeout&&(clearTimeout(workers.findOptimalTimeout),workers.findOptimalTimeout=null),!looksMobile()||"OFF"==a||confirm("Mining on a mobile device will increase battery usage and heat production. Please use carefully!"))){switch(a){case"OFF":for(;workers.length;)workers.removeWorker();miningBtn.innerHTML="Dig",miningBtn.onclick=function(){workers.switchMode("SLOW")},workers.mode="OFF",localStorage.setItem("mode","OFF");break;case"AUTO":for(;workers.length>1;)workers.removeWorker();workers.length?(workers.lastHashRate=0,workers.findOptimalTimeout=setTimeout(workers.findOptimal,15e3)):workers.findOptimal(),miningBtn.innerHTML="Stop",miningBtn.onclick=function(){workers.switchMode("OFF")},workers.mode="AUTO",localStorage.setItem("mode","AUTO");break;case"SLOW":if(workers.length>1)for(;workers.length>1;)workers.removeWorker();else 0==workers.length&&workers.addWorker();miningBtn.innerHTML="Find Max Speed",miningBtn.onclick=function(){workers.switchMode("AUTO")},workers.mode="SLOW",localStorage.setItem("mode","SLOW")}workers.updateInfo()}},workers.autoStart){var savedMode=localStorage.getItem("mode");workers.switchMode(savedMode?savedMode:"SLOW")}else workers.switchMode("OFF");setInterval(function(){var a=workers.getHashRate();a&&a>1&&(a=Math.floor(a),ga("send","event","hashrate",workers.type.toLowerCase(),workers.length,a))},12e4);